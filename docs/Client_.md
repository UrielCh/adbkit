# client

The ADB client List access and track android device

## API

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### IEmissions

enforce EventEmitter typing

### version

Queries the ADB server for its version. This is mainly useful for backwards-compatibility purposes.

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)<[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)>** The version of the ADB server.

### connect

Connects to the given device, which must have its ADB daemon running in tcp mode (see `client.tcpip()`) and be accessible on the same network. Same as `adb connect <host>:<port>`.

#### Parameters

*   `host` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** The target host. Can also contain the port, in which case the port argument is not used and can be skipped.
*   `port`  Optional. The target port. Defaults to `5555` (optional, default `5555`)

#### Examples

```javascript
// switch to TCP mode and set up a forward for Chrome devtools
import Adb from '@u4/adbkit';
const client = Adb.createClient();
// Note: be careful with using `client.listDevices()` together with `client.tcpip()`
// and other similar methods that modify the connection with ADB. You might have the
// same device twice in your device list (i.e. one device connected via both USB and
// TCP), which can cause havoc if run simultaneously.

const test = async () => {
    try {
        const devices = await client.listDevices();
        for (const device of devices) {
            const device = client.getDevice(device.id);
            const port = await device.tcpip();
            // Switching to TCP mode causes ADB to lose the device for a
            // moment, so let's just wait till we get it back.
            await device.waitForDevice();
            const ip = await device.getDHCPIpAddress();
            const deviceTCP = await client.connect(ip, port);
            // It can take a moment for the connection to happen.
            await deviceTCP.waitForDevice();
            await deviceTCP.forward('tcp:9222', 'localabstract:chrome_devtools_remote');
            console.log(`Setup devtools on "${id}"`);
        };
    } catch (err) {
        console.error('Something went wrong:', err.stack);
    }
};
```

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)<[boolean](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean)>** true is a new connetion is etablish, or false if already connected.

### disconnect

Disconnects from the given device, which should have been connected via `client.connect()` or just `adb connect <host>:<port>`.

#### Parameters

*   `host` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** The target host. Can also contain the port, in which case the port argument is not used and can be skipped. In other words you can just put the `id` you got from `client.connect()` here and it will be fine.
*   `port`  Optional. The target port. Defaults to `5555`. (optional, default `5555`)

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)\<DeviceClient>** The disconnected device ID. Will no longer be usable as a `serial` in other commands until you've connected again.

### listDevices

Gets the list of currently connected devices and emulators.

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)<[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)\<Device>>** An array of device objects. The device objects are plain JavaScript objects with two properties: `id` and `type`.

### listDevicesWithPaths

Like `client.listDevices()`, but includes the "path" of every device.

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)<[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)\<DeviceWithPath>>** An array of device objects.

### trackDevices

Gets a device tracker. Events will be emitted when devices are added, removed, or their type changes (i.e. to/from `offline`). Note that the same events will be emitted for the initially connected devices also, so that you don't need to use both `client.listDevices()` and `client.trackDevices()`.

Note that as the tracker will keep a connection open, you must call `tracker.end()` if you wish to stop tracking devices.

#### Examples

```javascript
// Tracking devices
import Adb from '@u4/adbkit';

const client = Adb.createClient();
const test = async () => {
    try {
        const tracker = await client.trackDevices();
        tracker.on('add', (device) => console.log('Device %s was plugged in', device.id));
        tracker.on('remove', (device) => console.log('Device %s was unplugged', device.id));
        tracker.on('end', () => console.log('Tracking stopped'));
    } catch (err) {
        console.error('Something went wrong:', err.stack);
    }
};
```

```javascript
// Tracking devices avoiding offline devices
import Adb from '@u4/adbkit';

const client = Adb.createClient();
const test = async () => {
    try {
        const tracker = await client.trackDevices();
        tracker.on('online', (device) => console.log('Device %s is online', device.id));
        tracker.on('offline', (device) => console.log('Device %s is offline', device.id));
        tracker.on('end', () => console.log('Tracking stopped'));
    } catch (err) {
        console.error('Something went wrong:', err.stack);
    }
};
```

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)\<Tracker>** 

### kill

This kills the ADB server. Note that the next connection will attempt to start the server again when it's unable to connect

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)<[boolean](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean)>** true

### getDevice

Get as DeviceClient attached to a device

#### Parameters

*   `serial` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** device serial number

Returns **DeviceClient** DeviceClient attached to a device
